#!/usr/bin/env groovy

node('docker-agent-php') {

    stage('Composer Install') {
        sh 'composer install'
    }

    stage("PHPLint") {
        sh 'find app -name "*.php" -print0 | xargs -0 -n1 php -l'
    }

    stage("PHPUnit") {
        sh './vendor/bin/phpunit test'
    }

   
/*
    stage("Publish Crap4J") { // broken at the moment
        step([$class: 'hudson.plugins.crap4j.Crap4JPublisher', reportPattern: 'build/logs/crap4j.xml', healthThreshold: '10'])
    }
*/

}
